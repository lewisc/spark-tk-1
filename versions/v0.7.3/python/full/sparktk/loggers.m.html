<!doctype html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />

    <title>sparktk.loggers API documentation</title>
    <meta name="description" content="Logging - simple helpers for now" />

  <link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:400,300' rel='stylesheet' type='text/css'>
  
  <style type="text/css">
  
* {
  box-sizing: border-box;
}
/*! normalize.css v1.1.1 | MIT License | git.io/normalize */

/* ==========================================================================
   HTML5 display definitions
   ========================================================================== */

/**
 * Correct `block` display not defined in IE 6/7/8/9 and Firefox 3.
 */

article,
aside,
details,
figcaption,
figure,
footer,
header,
hgroup,
main,
nav,
section,
summary {
    display: block;
}

/**
 * Correct `inline-block` display not defined in IE 6/7/8/9 and Firefox 3.
 */

audio,
canvas,
video {
    display: inline-block;
    *display: inline;
    *zoom: 1;
}

/**
 * Prevent modern browsers from displaying `audio` without controls.
 * Remove excess height in iOS 5 devices.
 */

audio:not([controls]) {
    display: none;
    height: 0;
}

/**
 * Address styling not present in IE 7/8/9, Firefox 3, and Safari 4.
 * Known issue: no IE 6 support.
 */

[hidden] {
    display: none;
}

/* ==========================================================================
   Base
   ========================================================================== */

/**
 * 1. Prevent system color scheme's background color being used in Firefox, IE,
 *    and Opera.
 * 2. Prevent system color scheme's text color being used in Firefox, IE, and
 *    Opera.
 * 3. Correct text resizing oddly in IE 6/7 when body `font-size` is set using
 *    `em` units.
 * 4. Prevent iOS text size adjust after orientation change, without disabling
 *    user zoom.
 */

html {
    background: #fff; /* 1 */
    color: #000; /* 2 */
    font-size: 100%; /* 3 */
    -webkit-text-size-adjust: 100%; /* 4 */
    -ms-text-size-adjust: 100%; /* 4 */
}

/**
 * Address `font-family` inconsistency between `textarea` and other form
 * elements.
 */

html,
button,
input,
select,
textarea {
    font-family: sans-serif;
}

/**
 * Address margins handled incorrectly in IE 6/7.
 */

body {
    margin: 0;
}

/* ==========================================================================
   Links
   ========================================================================== */

/**
 * Address `outline` inconsistency between Chrome and other browsers.
 */

a:focus {
    outline: thin dotted;
}

/**
 * Improve readability when focused and also mouse hovered in all browsers.
 */

a:active,
a:hover {
    outline: 0;
}

/* ==========================================================================
   Typography
   ========================================================================== */

/**
 * Address font sizes and margins set differently in IE 6/7.
 * Address font sizes within `section` and `article` in Firefox 4+, Safari 5,
 * and Chrome.
 */

h1 {
    font-size: 2em;
    margin: 0.67em 0;
}

h2 {
    font-size: 1.5em;
    margin: 0.83em 0;
}

h3 {
    font-size: 1.17em;
    margin: 1em 0;
}

h4 {
    font-size: 1em;
    margin: 1.33em 0;
}

h5 {
    font-size: 0.83em;
    margin: 1.67em 0;
}

h6 {
    font-size: 0.67em;
    margin: 2.33em 0;
}

/**
 * Address styling not present in IE 7/8/9, Safari 5, and Chrome.
 */

abbr[title] {
    border-bottom: 1px dotted;
}

/**
 * Address style set to `bolder` in Firefox 3+, Safari 4/5, and Chrome.
 */

b,
strong {
    font-weight: bold;
}

blockquote {
    margin: 1em 40px;
}

/**
 * Address styling not present in Safari 5 and Chrome.
 */

dfn {
    font-style: italic;
}

/**
 * Address differences between Firefox and other browsers.
 * Known issue: no IE 6/7 normalization.
 */

hr {
    -moz-box-sizing: content-box;
    box-sizing: content-box;
    height: 0;
}

/**
 * Address styling not present in IE 6/7/8/9.
 */

mark {
    background: #ff0;
    color: #000;
}

/**
 * Address margins set differently in IE 6/7.
 */

p,
pre {
    margin: 1em 0;
}

/**
 * Correct font family set oddly in IE 6, Safari 4/5, and Chrome.
 */

code,
kbd,
pre,
samp {
    font-family: monospace, serif;
    _font-family: 'courier new', monospace;
    font-size: 1em;
}

/**
 * Improve readability of pre-formatted text in all browsers.
 */

pre {
    white-space: pre;
    white-space: pre-wrap;
    word-wrap: break-word;
}

/**
 * Address CSS quotes not supported in IE 6/7.
 */

q {
    quotes: none;
}

/**
 * Address `quotes` property not supported in Safari 4.
 */

q:before,
q:after {
    content: '';
    content: none;
}

/**
 * Address inconsistent and variable font size in all browsers.
 */

small {
    font-size: 80%;
}

/**
 * Prevent `sub` and `sup` affecting `line-height` in all browsers.
 */

sub,
sup {
    font-size: 75%;
    line-height: 0;
    position: relative;
    vertical-align: baseline;
}

sup {
    top: -0.5em;
}

sub {
    bottom: -0.25em;
}

/* ==========================================================================
   Lists
   ========================================================================== */

/**
 * Address margins set differently in IE 6/7.
 */

dl,
menu,
ol,
ul {
    margin: 1em 0;
}

dd {
    margin: 0 0 0 40px;
}

/**
 * Address paddings set differently in IE 6/7.
 */

menu,
ol,
ul {
    padding: 0 0 0 40px;
}

/**
 * Correct list images handled incorrectly in IE 7.
 */

nav ul,
nav ol {
    list-style: none;
    list-style-image: none;
}

/* ==========================================================================
   Embedded content
   ========================================================================== */

/**
 * 1. Remove border when inside `a` element in IE 6/7/8/9 and Firefox 3.
 * 2. Improve image quality when scaled in IE 7.
 */

img {
    border: 0; /* 1 */
    -ms-interpolation-mode: bicubic; /* 2 */
}

/**
 * Correct overflow displayed oddly in IE 9.
 */

svg:not(:root) {
    overflow: hidden;
}

/* ==========================================================================
   Figures
   ========================================================================== */

/**
 * Address margin not present in IE 6/7/8/9, Safari 5, and Opera 11.
 */

figure {
    margin: 0;
}

/* ==========================================================================
   Forms
   ========================================================================== */

/**
 * Correct margin displayed oddly in IE 6/7.
 */

form {
    margin: 0;
}

/**
 * Define consistent border, margin, and padding.
 */

fieldset {
    border: 1px solid #c0c0c0;
    margin: 0 2px;
    padding: 0.35em 0.625em 0.75em;
}

/**
 * 1. Correct color not being inherited in IE 6/7/8/9.
 * 2. Correct text not wrapping in Firefox 3.
 * 3. Correct alignment displayed oddly in IE 6/7.
 */

legend {
    border: 0; /* 1 */
    padding: 0;
    white-space: normal; /* 2 */
    *margin-left: -7px; /* 3 */
}

/**
 * 1. Correct font size not being inherited in all browsers.
 * 2. Address margins set differently in IE 6/7, Firefox 3+, Safari 5,
 *    and Chrome.
 * 3. Improve appearance and consistency in all browsers.
 */

button,
input,
select,
textarea {
    font-size: 100%; /* 1 */
    margin: 0; /* 2 */
    vertical-align: baseline; /* 3 */
    *vertical-align: middle; /* 3 */
}

/**
 * Address Firefox 3+ setting `line-height` on `input` using `!important` in
 * the UA stylesheet.
 */

button,
input {
    line-height: normal;
}

/**
 * Address inconsistent `text-transform` inheritance for `button` and `select`.
 * All other form control elements do not inherit `text-transform` values.
 * Correct `button` style inheritance in Chrome, Safari 5+, and IE 6+.
 * Correct `select` style inheritance in Firefox 4+ and Opera.
 */

button,
select {
    text-transform: none;
}

/**
 * 1. Avoid the WebKit bug in Android 4.0.* where (2) destroys native `audio`
 *    and `video` controls.
 * 2. Correct inability to style clickable `input` types in iOS.
 * 3. Improve usability and consistency of cursor style between image-type
 *    `input` and others.
 * 4. Remove inner spacing in IE 7 without affecting normal text inputs.
 *    Known issue: inner spacing remains in IE 6.
 */

button,
html input[type="button"], /* 1 */
input[type="reset"],
input[type="submit"] {
    -webkit-appearance: button; /* 2 */
    cursor: pointer; /* 3 */
    *overflow: visible;  /* 4 */
}

/**
 * Re-set default cursor for disabled elements.
 */

button[disabled],
html input[disabled] {
    cursor: default;
}

/**
 * 1. Address box sizing set to content-box in IE 8/9.
 * 2. Remove excess padding in IE 8/9.
 * 3. Remove excess padding in IE 7.
 *    Known issue: excess padding remains in IE 6.
 */

input[type="checkbox"],
input[type="radio"] {
    box-sizing: border-box; /* 1 */
    padding: 0; /* 2 */
    *height: 13px; /* 3 */
    *width: 13px; /* 3 */
}

/**
 * 1. Address `appearance` set to `searchfield` in Safari 5 and Chrome.
 * 2. Address `box-sizing` set to `border-box` in Safari 5 and Chrome
 *    (include `-moz` to future-proof).
 */

input[type="search"] {
    -webkit-appearance: textfield; /* 1 */
    -moz-box-sizing: content-box;
    -webkit-box-sizing: content-box; /* 2 */
    box-sizing: content-box;
}

/**
 * Remove inner padding and search cancel button in Safari 5 and Chrome
 * on OS X.
 */

input[type="search"]::-webkit-search-cancel-button,
input[type="search"]::-webkit-search-decoration {
    -webkit-appearance: none;
}

/**
 * Remove inner padding and border in Firefox 3+.
 */

button::-moz-focus-inner,
input::-moz-focus-inner {
    border: 0;
    padding: 0;
}

/**
 * 1. Remove default vertical scrollbar in IE 6/7/8/9.
 * 2. Improve readability and alignment in all browsers.
 */

textarea {
    overflow: auto; /* 1 */
    vertical-align: top; /* 2 */
}

/* ==========================================================================
   Tables
   ========================================================================== */

/**
 * Remove most spacing between table cells.
 */

table {
    border-collapse: collapse;
    border-spacing: 0;
}

  </style>

  <style type="text/css">
  
  html, body {
    margin: 0;
    padding: 0;
    min-height: 100%;
  }
  body {
    background: #fff;
    font-family: Arial, Helvetica, sans;
    font-size: 14px;
  }
  #content {
    position: absolute;
    left: 25%;
    right: 0;
    top: 0;
    bottom: 0;
    overflow: auto;
    padding: 30px;
    height: 100%;
  }
  #sidebar {
    position: absolute;
    width: 25%;
    top: 0;
    right: 0;
    left: 0;
    padding: 30px;
    overflow: auto;
    height: 100%;
  }
  #nav {
    font-size: 130%;
    margin: 0 0 15px 0;
  }

  #top {
    display: block;
    position: fixed;
    bottom: 5px;
    left: 5px;
    font-size: .85em;
    text-transform: uppercase;
  }

  #fixed_top_left {
    display: block;
    position: fixed;
    top: 5px;
    left: 5px;
    font-size: .85em;
    text-transform: uppercase;
    background: transparent;
    z-index: 1;  /* Set z-index so that it doesn't get lost behind the sidebar */
  }

  #footer {
    font-size: .75em;
    margin-top: 20px;
    padding: 5px 30px;
    border-top: 1px solid #ddd;
    text-align: right;
  }
    #footer p {
      margin: 0 0 0 30px;
      display: inline-block;
    }

  h1, h2, h3, h4, h5 {
    font-weight: 300;
  }
  h1 {
    font-size: 2.5em;
    line-height: 1.1em;
    margin: 0 0 .50em 0;
  }

  h2 {
    font-size: 1.75em;
    margin: 1em 0 .50em 0;
  }

  h3 {
    font-size: 1.5em;
    margin: 25px 0 10px 0;
  }

  h4 {
    margin: 0;
    font-size: 105%;
  }

  a {
    color: #058;
    text-decoration: none;
    transition: color .3s ease-in-out;
  }

  a:hover {
    color: #e08524;
    transition: color .3s ease-in-out;
  }

  pre, code, .mono, .name, .param-name {
    font-family: Consolas, "Ubuntu Mono", "Cousine", "DejaVu Sans Mono", monospace;
  }

  .title .name {
    font-weight: bold;
  }
  .section-title {
    margin-top: 2em;
  }
  .ident {
    color: #900;
  }
  .section-header {
    font-weight: bold;
    padding: 10px 0 5px 0;
  }
  .param-name {
    font-weight: bold;
    text-align: left;
    vertical-align: top;
  }
  .param-type {
    font-style: italic;
    text-align: left;
    vertical-align: top;
    padding-left: 5px;
  }
  .param-desc {
    text-align: left;
    vertical-align: top;
    padding-left: 5px;
  }
  code {
    background: #f9f9f9;
  } 

  pre {
    background: #fefefe;
    border: 1px solid #ddd;
    box-shadow: 2px 2px 0 #f3f3f3;
    margin: 0 30px;
    padding: 15px 30px;
  }

  .codehilite {
    margin: 0 30px 10px 30px;
  }

    .codehilite pre {
      margin: 0;
      background: #f9f9f9;
      font-size: 13px;
    }
    .codehilite .err { background: #ff3300; color: #fff !important; } 

  table#module-list {
    font-size: 110%;
  }

    table#module-list tr td:first-child {
      padding-right: 10px;
      white-space: nowrap;
    }

    table#module-list td {
      vertical-align: top;
      padding-bottom: 8px;
    }

      table#module-list td p {
        margin: 0 0 7px 0;
      }

  .def {
    display: table;
  }

    .def p {
      display: table-cell;
      vertical-align: top;
      text-align: left;
    }

    .def p:first-child {
      white-space: nowrap;
    }

    .def p:last-child {
      width: 100%;
    }


  #index {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }
    ul#index .class_name {
      /* font-size: 110%; */
      font-weight: bold;
    }
    #index ul {
      margin: 0;
    }

  .item {
    margin: 0 0 15px 0;
  }

    .item .class {
      margin: 0 0 25px 30px;
    }

      .item .class ul.class_list {
        margin: 0 0 20px 0;
      }

    .item .name {
      background: #fafafa;
      margin: 0;
      font-weight: bold;
      padding: 5px 10px;
      border-radius: 3px;
      display: inline-block;
      min-width: 40%;
    }
      .item .name:hover {
        background: #f6f6f6;
      }

    .item .empty_desc {
      margin: 0 0 5px 0;
      padding: 0;
    }

    .item .inheritance {
      margin: 3px 0 0 30px;
    }

    .item .inherited {
      color: #666;
    }

    .item .desc {
      padding: 0 20px 0 8px;
      margin: 0;
    }

      .item .desc p {
        margin: 0 0 10px 0;
      }

    .source_cont {
      margin: 0;
      padding: 0;
    }

    .source_link a {
      background: #ffc300;
      font-weight: 400;
      font-size: .75em;
      text-transform: uppercase;
      color: #fff;
      text-shadow: 1px 1px 0 #f4b700;
      
      padding: 3px 8px;
      border-radius: 2px;
      transition: background .3s ease-in-out;
    }
      .source_link a:hover {
        background: #FF7200;
        text-shadow: none;
        transition: background .3s ease-in-out;
      }

    .source {
      display: none;
      max-height: 600px;
      overflow-y: scroll;
      margin-bottom: 15px;
    }

      .source .codehilite {
        margin: 0;
      }

  .desc h1, .desc h2, .desc h3 {
    font-size: 100% !important;
  }
  .clear {
    clear: both;
  }

  @media all and (max-width: 950px) {
    #sidebar {
      width: 35%;
    }
    #content {
      width: 65%;
    }
  }
  @media all and (max-width: 650px) {
    #top {
      display: none;
    }
    #sidebar {
      float: none;
      width: auto;
    }
    #content {
      float: none;
      width: auto;
      padding: 30px;
    }

    #index ul {
      padding: 0;
      margin-bottom: 15px;
    }
    #index ul li {
      display: inline-block;
      margin-right: 30px;
    }
    #footer {
      text-align: left;
    }
    #footer p {
      display: block;
      margin: inherit;
    }
  }

  /*****************************/

  </style>


  <style type="text/css">
  
/* ==========================================================================
   EXAMPLE Media Queries for Responsive Design.
   These examples override the primary ('mobile first') styles.
   Modify as content requires.
   ========================================================================== */

@media only screen and (min-width: 35em) {
    /* Style adjustments for viewports that meet the condition */
}

@media print,
       (-o-min-device-pixel-ratio: 5/4),
       (-webkit-min-device-pixel-ratio: 1.25),
       (min-resolution: 120dpi) {
    /* Style adjustments for high resolution devices */
}

/* ==========================================================================
   Print styles.
   Inlined to avoid required HTTP connection: h5bp.com/r
   ========================================================================== */

@media print {
    * {
        background: transparent !important;
        color: #000 !important; /* Black prints faster: h5bp.com/s */
        box-shadow: none !important;
        text-shadow: none !important;
    }

    a,
    a:visited {
        text-decoration: underline;
    }

    a[href]:after {
        content: " (" attr(href) ")";
    }

    abbr[title]:after {
        content: " (" attr(title) ")";
    }

    /*
     * Don't show links for images, or javascript/internal links
     */

    .ir a:after,
    a[href^="javascript:"]:after,
    a[href^="#"]:after {
        content: "";
    }

    pre,
    blockquote {
        border: 1px solid #999;
        page-break-inside: avoid;
    }

    thead {
        display: table-header-group; /* h5bp.com/t */
    }

    tr,
    img {
        page-break-inside: avoid;
    }

    img {
        max-width: 100% !important;
    }

    @page {
        margin: 0.5cm;
    }

    p,
    h2,
    h3 {
        orphans: 3;
        widows: 3;
    }

    h2,
    h3 {
        page-break-after: avoid;
    }
}

  </style>

  <script type="text/javascript">
  function toggle(id, $link) {
    $node = document.getElementById(id);
    if (!$node)
    return;
    if (!$node.style.display || $node.style.display == 'none') {
    $node.style.display = 'block';
    $link.innerHTML = 'Hide source &nequiv;';
    } else {
    $node.style.display = 'none';
    $link.innerHTML = 'Show source &equiv;';
    }
  }
  </script>
</head>
<body>
  <a href="index.html" id="fixed_top_left">Up</a>
  <!--<a href="#" id="top">Top</a>-->
  <div id="container">
      
  
  <div id="sidebar">
    <h1>Index</h1>
    <ul id="index">
    <li class="set"><h3><a href="#header-variables">Module variables</a></h3>
      
  <ul>
    <li class="mono"><a href="#sparktk.loggers.LINE_FORMAT">LINE_FORMAT</a></li>
    <li class="mono"><a href="#sparktk.loggers.loggers">loggers</a></li>
    <li class="mono"><a href="#sparktk.loggers.loggers_env">loggers_env</a></li>
    <li class="mono"><a href="#sparktk.loggers.loggers_env_name">loggers_env_name</a></li>
  </ul>

    </li>

    <li class="set"><h3><a href="#header-functions">Functions</a></h3>
      
  <ul>
    <li class="mono"><a href="#sparktk.loggers.log_load">log_load</a></li>
  </ul>

    </li>

    <li class="set"><h3><a href="#header-classes">Classes</a></h3>
      <ul>
        <li class="mono">
        <span class="class_name"><a href="#sparktk.loggers.Loggers">Loggers</a></span>
        
          
  <ul>
    <li class="mono"><a href="#sparktk.loggers.Loggers.get">get</a></li>
    <li class="mono"><a href="#sparktk.loggers.Loggers.set_spark">set_spark</a></li>
    <li class="mono"><a href="#sparktk.loggers.Loggers.set_sparktk_scala">set_sparktk_scala</a></li>
    <li class="mono"><a href="#sparktk.loggers.Loggers.__init__">__init__</a></li>
    <li class="mono"><a href="#sparktk.loggers.Loggers.set">set</a></li>
  </ul>

        </li>
        <li class="mono">
        <span class="class_name"><a href="#sparktk.loggers.NullHandler">NullHandler</a></span>
        
          
  <ul>
    <li class="mono"><a href="#sparktk.loggers.NullHandler.__init__">__init__</a></li>
    <li class="mono"><a href="#sparktk.loggers.NullHandler.acquire">acquire</a></li>
    <li class="mono"><a href="#sparktk.loggers.NullHandler.addFilter">addFilter</a></li>
    <li class="mono"><a href="#sparktk.loggers.NullHandler.close">close</a></li>
    <li class="mono"><a href="#sparktk.loggers.NullHandler.createLock">createLock</a></li>
    <li class="mono"><a href="#sparktk.loggers.NullHandler.emit">emit</a></li>
    <li class="mono"><a href="#sparktk.loggers.NullHandler.filter">filter</a></li>
    <li class="mono"><a href="#sparktk.loggers.NullHandler.flush">flush</a></li>
    <li class="mono"><a href="#sparktk.loggers.NullHandler.format">format</a></li>
    <li class="mono"><a href="#sparktk.loggers.NullHandler.get_name">get_name</a></li>
    <li class="mono"><a href="#sparktk.loggers.NullHandler.handle">handle</a></li>
    <li class="mono"><a href="#sparktk.loggers.NullHandler.handleError">handleError</a></li>
    <li class="mono"><a href="#sparktk.loggers.NullHandler.release">release</a></li>
    <li class="mono"><a href="#sparktk.loggers.NullHandler.removeFilter">removeFilter</a></li>
    <li class="mono"><a href="#sparktk.loggers.NullHandler.setFormatter">setFormatter</a></li>
    <li class="mono"><a href="#sparktk.loggers.NullHandler.setLevel">setLevel</a></li>
    <li class="mono"><a href="#sparktk.loggers.NullHandler.set_name">set_name</a></li>
  </ul>

        </li>
      </ul>
    </li>

    </ul>
  </div>

      <article id="content">
        <div>
        
  

  


  <header id="section-intro">
  <h1 class="title"><span class="name">sparktk.loggers</span> module</h1>
  <p>Logging - simple helpers for now</p>
  
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-sparktk.loggers', this);">Show source &equiv;</a></p>
  <div id="source-sparktk.loggers" class="source">
    <pre><code># vim: set encoding=utf-8

#  Copyright (c) 2016 Intel Corporation 
#
#  Licensed under the Apache License, Version 2.0 (the "License");
#  you may not use this file except in compliance with the License.
#  You may obtain a copy of the License at
#
#       http://www.apache.org/licenses/LICENSE-2.0
#
#  Unless required by applicable law or agreed to in writing, software
#  distributed under the License is distributed on an "AS IS" BASIS,
#  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
#  See the License for the specific language governing permissions and
#  limitations under the License.
#

"""
Logging - simple helpers for now
"""
import logging
import sys

# Constants
LINE_FORMAT = '%(asctime)s|%(levelname)-5s|%(name)s|%(message)s'

# add a null handler to root logger to avoid handler warning messages
class NullHandler(logging.Handler):
    name = "NullHandler"

    def emit(self, record):
        pass

# this line avoids the 'no handler' warning msg when no logging is set at all
_null_handler = NullHandler()
_null_handler.name = ''  # add name explicitly for python 2.6
logging.getLogger('').addHandler(_null_handler)


class Loggers(object):
    """
    Collection of loggers to stderr, wrapped for simplicity
    """

    # map first character of level to actual level setting, for convenience
    _level_map = {'c': logging.CRITICAL,
                  'f': logging.FATAL,
                  'e': logging.ERROR,
                  'w': logging.WARN,
                  'i': logging.INFO,
                  'd': logging.DEBUG,
                  'n': logging.NOTSET}

    def __init__(self):
        self._user_logger_names = []

    def __repr__(self):
        header = ["{0:<8}  {1:<50}  {2:<14}".format("Level", "Logger", "# of Handlers"),
                  "{0:<8}  {1:<50}  {2:<14}".format("-"*8, "-"*50, "-"*14)]
        entries = []
        for name in self._user_logger_names:
            entries.append(self._get_repr_line(name, None))
        return "\n".join(header + entries)

    @staticmethod
    def _get_repr_line(name, alias):
        logger = logging.getLogger(name)
        if alias:
            name += " (%s)" % alias
        return "{0:<8}  {1:<50}  {2:<14}".format(logging.getLevelName(logger.level),
                                                 name,
                                                 len(logger.handlers))

    @staticmethod
    def get(logger_name):
        """returns the logger of the given name"""
        return logging.getLogger(logger_name)

    def set(self, level=logging.DEBUG, logger_name='', output=None, line_format=None):
        """
        Sets the level and adds handlers to the given logger

        Parameters
        ----------
        level : int, str or logging.*, optional
            The level to which the logger will be set.  May be 0,10,20,30,40,50
            or "DEBUG", "INFO", etc.  (only first letter is requirecd)
            Setting to None disables the logging to stderr
            See `https://docs.python.org/2/library/logging.html`
            If not specified, DEBUG is used
            To turn OFF the logger, set level to 0 or None
        logger_name: str, optional
            The name of the logger.  If empty string, then the sparktk root logger is set
        output: file or str, or list of such, optional
            The file object or name of the file to log to.  If empty, then stderr is used

        Examples
        --------
        # to enable INFO level logging to file 'log.txt' and no printing to stderr:
        >>> loggers.set('INFO', 'sparktk.frame','log.txt', False)
        """
        logger_name = logger_name if logger_name != 'root' else ''
        if not level:
            return self._turn_logger_off(logger_name)

        line_format = line_format if line_format is not None else LINE_FORMAT
        logger = logging.getLogger(logger_name)
        if not output:
            output = sys.stderr
        if isinstance(output, basestring):
            handler = logging.FileHandler(output)
        elif isinstance(output, list) or isinstance(output, tuple):
            logger = None
            for o in output:
                logger = self.set(level, logger_name, o, line_format)
            return logger
        else:
            try:
                handler = logging.StreamHandler(output)
            except:
                raise ValueError("Bad output argument %s.  Expected stream or file name." % output)

        try:
            handler_name = output.name
        except:
            handler_name = str(output)

        if isinstance(level, basestring):
            c = str(level)[0].lower()  # only require first letter
            level = self._level_map[c]
        logger.setLevel(level)

        self._add_handler_to_logger(logger, handler, handler_name, line_format)

        # store logger name
        if logger_name not in self._user_logger_names:
            self._user_logger_names.append(logger_name)
        return logger

    @staticmethod
    def _logger_has_handler(logger, handler_name):
        return logger.handlers and any([h.name for h in logger.handlers if h.name == handler_name])

    @staticmethod
    def _add_handler_to_logger(logger, handler, handler_name, line_format):
        handler.setLevel(logging.DEBUG)
        handler.name = handler_name
        formatter = logging.Formatter(line_format, '%y-%m-%d %H:%M:%S')
        handler.setFormatter(formatter)
        logger.addHandler(handler)

    def _turn_logger_off(self, logger_name):
        logger = logging.getLogger(logger_name)
        logger.level = logging.CRITICAL
        victim_handlers = [x for x in logger.handlers]
        for h in victim_handlers:
            logger.removeHandler(h)
        try:
            self._user_logger_names.remove(logger_name)
        except ValueError:
            pass
        return logger

    @staticmethod
    def set_spark(sc, level):
        """
        Controls the logging level for the messages generated by Spark

        :param sc: (SparkContext) valid SparkContext (python)
        :param level: (str) log level, like "info", "debug", "warn", etc.
        """
        from pyspark import SparkContext
        if not isinstance(sc, SparkContext):
            raise TypeError("set_spark requires a valid SparkContext object for first arg, received type=%s" % type(sc))
        logger = sc._jvm.org.apache.log4j
        new_level = Loggers._get_scala_logger_level(sc, level)

        logger.LogManager.getLogger("org").setLevel(new_level)
        logger.LogManager.getLogger("akka").setLevel(new_level)

    @staticmethod
    def set_sparktk_scala(tc, level):
        """
        Controls the logging level for the messages generated by the Scala part of sparktk

        :param tc: (TkContext) valid TkContext (python)
        :param level: (str) log level, like "info", "debug", "warn", etc.
        """
        tc._jtc.setLoggerLevel(str(Loggers._get_scala_logger_level(tc.sc, level)))

    @staticmethod
    def _get_scala_logger_level(sc, level_string):
        logger = sc._jvm.org.apache.log4j
        if not level_string:
            level = "<unspecified>"
        valid_levels = {
            "d": logger.Level.DEBUG,
            "e": logger.Level.ERROR,
            "w": logger.Level.WARN,
            "i": logger.Level.INFO,
            "o": logger.Level.OFF,
        }
        try:
            return valid_levels[level_string.lower()[0]]
        except KeyError:
            raise ValueError("Bad logging level '%s'.  Valid levels include: %s" % (level_string, sorted(map(lambda lev: str(lev.toString()).lower(), valid_levels.values()))))


def log_load(module, logger_name='sparktk'):
    """
    intended to log when a module is imported

    Usage is to put a line like this at the top of the .py file:

    ``from sparktk.loggers import log_load; log_load(__name__); del log_load``

    :param module: name of the module, usually __name__
    :param logger_name: override the logger name
    """
    logger = logging.getLogger(logger_name)
    logger.info("load module %s" % module)


loggers = Loggers()


# Logging backdoor
#
# If env variable is set, we will call loggers.set immediately, so the loggers
# can run during the rest of the sparktk package import
#
# The value of this env var is a JSON list containing map, each of which
# represents a call to loggers.set.  The map holds the **kwargs for the
# call to loggers.set
#
# Example:  This sets the module logger to debug for core/frame.py
#
# $ export SPARK_TK_LOGGERS='[{"logger_name": "sparktk", "level": "debug"}]'
#
import os
loggers_env_name = "SPARK_TK_LOGGERS"
loggers_env = os.getenv(loggers_env_name)
if loggers_env:
    print "$SPARK_TK_LOGGERS=%s" % loggers_env
    try:
        import json
        for entry in json.loads(loggers_env):
            loggers.set(**entry)
    except Exception as e:
        import sys
        sys.stderr.write("!! Error trying to ingest logging env variable $%s\n" % loggers_env_name)
        raise
</code></pre>
  </div>

  </header>

  <section id="section-items">
    <h2 class="section-title" id="header-variables">Module variables</h2>
      <div class="item">
      <p id="sparktk.loggers.LINE_FORMAT" class="name">var <span class="ident">LINE_FORMAT</span></p>
      
  
  <div class="source_cont">
</div>

      </div>
      <div class="item">
      <p id="sparktk.loggers.loggers" class="name">var <span class="ident">loggers</span></p>
      
  
  <div class="source_cont">
</div>

      </div>
      <div class="item">
      <p id="sparktk.loggers.loggers_env" class="name">var <span class="ident">loggers_env</span></p>
      
  
  <div class="source_cont">
</div>

      </div>
      <div class="item">
      <p id="sparktk.loggers.loggers_env_name" class="name">var <span class="ident">loggers_env_name</span></p>
      
  
  <div class="source_cont">
</div>

      </div>

    <h2 class="section-title" id="header-functions">Functions</h2>
      
  <div class="item">
    <div class="name def" id="sparktk.loggers.log_load">
    <p>def <span class="ident">log_load</span>(</p><p>module, logger_name=&#39;sparktk&#39;)</p>
    </div>
    

    
  
    <div class="desc"><p>intended to log when a module is imported</p>
<p>Usage is to put a line like this at the top of the .py file:</p>
<p><code>from sparktk.loggers import log_load; log_load(__name__); del log_load</code></p>
<table><tr><td class='param-name'>module: </td><td class='param-desc'>name of the module, usually __name__
</td></tr></table>

<p>:param logger_name: override the logger name</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-sparktk.loggers.log_load', this);">Show source &equiv;</a></p>
  <div id="source-sparktk.loggers.log_load" class="source">
    <pre><code>def log_load(module, logger_name='sparktk'):
    """
    intended to log when a module is imported

    Usage is to put a line like this at the top of the .py file:

    ``from sparktk.loggers import log_load; log_load(__name__); del log_load``

    :param module: name of the module, usually __name__
    :param logger_name: override the logger name
    """
    logger = logging.getLogger(logger_name)
    logger.info("load module %s" % module)
</code></pre>
  </div>
</div>

  </div>
  

    <h2 class="section-title" id="header-classes">Classes</h2>
      
      <div class="item">
      <p id="sparktk.loggers.Loggers" class="name">class <span class="ident">Loggers</span></p>
      
  
    <div class="desc"><p>Collection of loggers to stderr, wrapped for simplicity</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-sparktk.loggers.Loggers', this);">Show source &equiv;</a></p>
  <div id="source-sparktk.loggers.Loggers" class="source">
    <pre><code>class Loggers(object):
    """
    Collection of loggers to stderr, wrapped for simplicity
    """

    # map first character of level to actual level setting, for convenience
    _level_map = {'c': logging.CRITICAL,
                  'f': logging.FATAL,
                  'e': logging.ERROR,
                  'w': logging.WARN,
                  'i': logging.INFO,
                  'd': logging.DEBUG,
                  'n': logging.NOTSET}

    def __init__(self):
        self._user_logger_names = []

    def __repr__(self):
        header = ["{0:<8}  {1:<50}  {2:<14}".format("Level", "Logger", "# of Handlers"),
                  "{0:<8}  {1:<50}  {2:<14}".format("-"*8, "-"*50, "-"*14)]
        entries = []
        for name in self._user_logger_names:
            entries.append(self._get_repr_line(name, None))
        return "\n".join(header + entries)

    @staticmethod
    def _get_repr_line(name, alias):
        logger = logging.getLogger(name)
        if alias:
            name += " (%s)" % alias
        return "{0:<8}  {1:<50}  {2:<14}".format(logging.getLevelName(logger.level),
                                                 name,
                                                 len(logger.handlers))

    @staticmethod
    def get(logger_name):
        """returns the logger of the given name"""
        return logging.getLogger(logger_name)

    def set(self, level=logging.DEBUG, logger_name='', output=None, line_format=None):
        """
        Sets the level and adds handlers to the given logger

        Parameters
        ----------
        level : int, str or logging.*, optional
            The level to which the logger will be set.  May be 0,10,20,30,40,50
            or "DEBUG", "INFO", etc.  (only first letter is requirecd)
            Setting to None disables the logging to stderr
            See `https://docs.python.org/2/library/logging.html`
            If not specified, DEBUG is used
            To turn OFF the logger, set level to 0 or None
        logger_name: str, optional
            The name of the logger.  If empty string, then the sparktk root logger is set
        output: file or str, or list of such, optional
            The file object or name of the file to log to.  If empty, then stderr is used

        Examples
        --------
        # to enable INFO level logging to file 'log.txt' and no printing to stderr:
        >>> loggers.set('INFO', 'sparktk.frame','log.txt', False)
        """
        logger_name = logger_name if logger_name != 'root' else ''
        if not level:
            return self._turn_logger_off(logger_name)

        line_format = line_format if line_format is not None else LINE_FORMAT
        logger = logging.getLogger(logger_name)
        if not output:
            output = sys.stderr
        if isinstance(output, basestring):
            handler = logging.FileHandler(output)
        elif isinstance(output, list) or isinstance(output, tuple):
            logger = None
            for o in output:
                logger = self.set(level, logger_name, o, line_format)
            return logger
        else:
            try:
                handler = logging.StreamHandler(output)
            except:
                raise ValueError("Bad output argument %s.  Expected stream or file name." % output)

        try:
            handler_name = output.name
        except:
            handler_name = str(output)

        if isinstance(level, basestring):
            c = str(level)[0].lower()  # only require first letter
            level = self._level_map[c]
        logger.setLevel(level)

        self._add_handler_to_logger(logger, handler, handler_name, line_format)

        # store logger name
        if logger_name not in self._user_logger_names:
            self._user_logger_names.append(logger_name)
        return logger

    @staticmethod
    def _logger_has_handler(logger, handler_name):
        return logger.handlers and any([h.name for h in logger.handlers if h.name == handler_name])

    @staticmethod
    def _add_handler_to_logger(logger, handler, handler_name, line_format):
        handler.setLevel(logging.DEBUG)
        handler.name = handler_name
        formatter = logging.Formatter(line_format, '%y-%m-%d %H:%M:%S')
        handler.setFormatter(formatter)
        logger.addHandler(handler)

    def _turn_logger_off(self, logger_name):
        logger = logging.getLogger(logger_name)
        logger.level = logging.CRITICAL
        victim_handlers = [x for x in logger.handlers]
        for h in victim_handlers:
            logger.removeHandler(h)
        try:
            self._user_logger_names.remove(logger_name)
        except ValueError:
            pass
        return logger

    @staticmethod
    def set_spark(sc, level):
        """
        Controls the logging level for the messages generated by Spark

        :param sc: (SparkContext) valid SparkContext (python)
        :param level: (str) log level, like "info", "debug", "warn", etc.
        """
        from pyspark import SparkContext
        if not isinstance(sc, SparkContext):
            raise TypeError("set_spark requires a valid SparkContext object for first arg, received type=%s" % type(sc))
        logger = sc._jvm.org.apache.log4j
        new_level = Loggers._get_scala_logger_level(sc, level)

        logger.LogManager.getLogger("org").setLevel(new_level)
        logger.LogManager.getLogger("akka").setLevel(new_level)

    @staticmethod
    def set_sparktk_scala(tc, level):
        """
        Controls the logging level for the messages generated by the Scala part of sparktk

        :param tc: (TkContext) valid TkContext (python)
        :param level: (str) log level, like "info", "debug", "warn", etc.
        """
        tc._jtc.setLoggerLevel(str(Loggers._get_scala_logger_level(tc.sc, level)))

    @staticmethod
    def _get_scala_logger_level(sc, level_string):
        logger = sc._jvm.org.apache.log4j
        if not level_string:
            level = "<unspecified>"
        valid_levels = {
            "d": logger.Level.DEBUG,
            "e": logger.Level.ERROR,
            "w": logger.Level.WARN,
            "i": logger.Level.INFO,
            "o": logger.Level.OFF,
        }
        try:
            return valid_levels[level_string.lower()[0]]
        except KeyError:
            raise ValueError("Bad logging level '%s'.  Valid levels include: %s" % (level_string, sorted(map(lambda lev: str(lev.toString()).lower(), valid_levels.values()))))
</code></pre>
  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#sparktk.loggers.Loggers">Loggers</a></li>
          <li>__builtin__.object</li>
          </ul>
          <h3>Static methods</h3>
            
  <div class="item">
    <div class="name def" id="sparktk.loggers.Loggers.get">
    <p>def <span class="ident">get</span>(</p><p>logger_name)</p>
    </div>
    

    
  
    <div class="desc"><p>returns the logger of the given name</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-sparktk.loggers.Loggers.get', this);">Show source &equiv;</a></p>
  <div id="source-sparktk.loggers.Loggers.get" class="source">
    <pre><code>@staticmethod
def get(logger_name):
    """returns the logger of the given name"""
    return logging.getLogger(logger_name)
</code></pre>
  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="sparktk.loggers.Loggers.set_spark">
    <p>def <span class="ident">set_spark</span>(</p><p>sc, level)</p>
    </div>
    

    
  
    <div class="desc"><p>Controls the logging level for the messages generated by Spark</p>
<table><tr><td class='param-name'>sc</td><td class='param-type'>(SparkContext):</td><td class='param-desc'>valid SparkContext (python)
</td></tr></table>

<table><tr><td class='param-name'>level</td><td class='param-type'>(str):</td><td class='param-desc'>log level, like "info", "debug", "warn", etc.</td></tr></table></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-sparktk.loggers.Loggers.set_spark', this);">Show source &equiv;</a></p>
  <div id="source-sparktk.loggers.Loggers.set_spark" class="source">
    <pre><code>@staticmethod
def set_spark(sc, level):
    """
    Controls the logging level for the messages generated by Spark
    :param sc: (SparkContext) valid SparkContext (python)
    :param level: (str) log level, like "info", "debug", "warn", etc.
    """
    from pyspark import SparkContext
    if not isinstance(sc, SparkContext):
        raise TypeError("set_spark requires a valid SparkContext object for first arg, received type=%s" % type(sc))
    logger = sc._jvm.org.apache.log4j
    new_level = Loggers._get_scala_logger_level(sc, level)
    logger.LogManager.getLogger("org").setLevel(new_level)
    logger.LogManager.getLogger("akka").setLevel(new_level)
</code></pre>
  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="sparktk.loggers.Loggers.set_sparktk_scala">
    <p>def <span class="ident">set_sparktk_scala</span>(</p><p>tc, level)</p>
    </div>
    

    
  
    <div class="desc"><p>Controls the logging level for the messages generated by the Scala part of sparktk</p>
<table><tr><td class='param-name'>tc</td><td class='param-type'>(TkContext):</td><td class='param-desc'>valid TkContext (python)
</td></tr></table>

<table><tr><td class='param-name'>level</td><td class='param-type'>(str):</td><td class='param-desc'>log level, like "info", "debug", "warn", etc.</td></tr></table></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-sparktk.loggers.Loggers.set_sparktk_scala', this);">Show source &equiv;</a></p>
  <div id="source-sparktk.loggers.Loggers.set_sparktk_scala" class="source">
    <pre><code>@staticmethod
def set_sparktk_scala(tc, level):
    """
    Controls the logging level for the messages generated by the Scala part of sparktk
    :param tc: (TkContext) valid TkContext (python)
    :param level: (str) log level, like "info", "debug", "warn", etc.
    """
    tc._jtc.setLoggerLevel(str(Loggers._get_scala_logger_level(tc.sc, level)))
</code></pre>
  </div>
</div>

  </div>
  
          <h3>Methods</h3>
            
  <div class="item">
    <div class="name def" id="sparktk.loggers.Loggers.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-sparktk.loggers.Loggers.__init__', this);">Show source &equiv;</a></p>
  <div id="source-sparktk.loggers.Loggers.__init__" class="source">
    <pre><code>def __init__(self):
    self._user_logger_names = []
</code></pre>
  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="sparktk.loggers.Loggers.set">
    <p>def <span class="ident">set</span>(</p><p>self, level=10, logger_name=&#39;&#39;, output=None, line_format=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Sets the level and adds handlers to the given logger</p>
<div class='section-header'>Parameters:</div>

<p>level : int, str or logging.*, optional
    The level to which the logger will be set.  May be 0,10,20,30,40,50
    or "DEBUG", "INFO", etc.  (only first letter is requirecd)
    Setting to None disables the logging to stderr
    See <code>https://docs.python.org/2/library/logging.html</code>
    If not specified, DEBUG is used
    To turn OFF the logger, set level to 0 or None
logger_name: str, optional
    The name of the logger.  If empty string, then the sparktk root logger is set
output: file or str, or list of such, optional
    The file object or name of the file to log to.  If empty, then stderr is used</p>
<div class='section-header'>Examples:</div>

<h1>to enable INFO level logging to file 'log.txt' and no printing to stderr:</h1>
<blockquote>
<blockquote>
<blockquote>
<p>loggers.set('INFO', 'sparktk.frame','log.txt', False)</p>
</blockquote>
</blockquote>
</blockquote></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-sparktk.loggers.Loggers.set', this);">Show source &equiv;</a></p>
  <div id="source-sparktk.loggers.Loggers.set" class="source">
    <pre><code>def set(self, level=logging.DEBUG, logger_name='', output=None, line_format=None):
    """
    Sets the level and adds handlers to the given logger
    Parameters
    ----------
    level : int, str or logging.*, optional
        The level to which the logger will be set.  May be 0,10,20,30,40,50
        or "DEBUG", "INFO", etc.  (only first letter is requirecd)
        Setting to None disables the logging to stderr
        See `https://docs.python.org/2/library/logging.html`
        If not specified, DEBUG is used
        To turn OFF the logger, set level to 0 or None
    logger_name: str, optional
        The name of the logger.  If empty string, then the sparktk root logger is set
    output: file or str, or list of such, optional
        The file object or name of the file to log to.  If empty, then stderr is used
    Examples
    --------
    # to enable INFO level logging to file 'log.txt' and no printing to stderr:
    >>> loggers.set('INFO', 'sparktk.frame','log.txt', False)
    """
    logger_name = logger_name if logger_name != 'root' else ''
    if not level:
        return self._turn_logger_off(logger_name)
    line_format = line_format if line_format is not None else LINE_FORMAT
    logger = logging.getLogger(logger_name)
    if not output:
        output = sys.stderr
    if isinstance(output, basestring):
        handler = logging.FileHandler(output)
    elif isinstance(output, list) or isinstance(output, tuple):
        logger = None
        for o in output:
            logger = self.set(level, logger_name, o, line_format)
        return logger
    else:
        try:
            handler = logging.StreamHandler(output)
        except:
            raise ValueError("Bad output argument %s.  Expected stream or file name." % output)
    try:
        handler_name = output.name
    except:
        handler_name = str(output)
    if isinstance(level, basestring):
        c = str(level)[0].lower()  # only require first letter
        level = self._level_map[c]
    logger.setLevel(level)
    self._add_handler_to_logger(logger, handler, handler_name, line_format)
    # store logger name
    if logger_name not in self._user_logger_names:
        self._user_logger_names.append(logger_name)
    return logger
</code></pre>
  </div>
</div>

  </div>
  
      </div>
      </div>
      
      <div class="item">
      <p id="sparktk.loggers.NullHandler" class="name">class <span class="ident">NullHandler</span></p>
      
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-sparktk.loggers.NullHandler', this);">Show source &equiv;</a></p>
  <div id="source-sparktk.loggers.NullHandler" class="source">
    <pre><code>class NullHandler(logging.Handler):
    name = "NullHandler"

    def emit(self, record):
        pass
</code></pre>
  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#sparktk.loggers.NullHandler">NullHandler</a></li>
          <li>logging.Handler</li>
          <li>logging.Filterer</li>
          <li>__builtin__.object</li>
          </ul>
          <h3>Class variables</h3>
            <div class="item">
            <p id="sparktk.loggers.NullHandler.name" class="name">var <span class="ident">name</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
          <h3>Methods</h3>
            
  <div class="item">
    <div class="name def" id="sparktk.loggers.NullHandler.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, level=0)</p>
    </div>
    

    
  
    <div class="desc"><p>Initializes the instance - basically setting the formatter to None
and the filter list to empty.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-sparktk.loggers.NullHandler.__init__', this);">Show source &equiv;</a></p>
  <div id="source-sparktk.loggers.NullHandler.__init__" class="source">
    <pre><code>def __init__(self, level=NOTSET):
    """
    Initializes the instance - basically setting the formatter to None
    and the filter list to empty.
    """
    Filterer.__init__(self)
    self._name = None
    self.level = _checkLevel(level)
    self.formatter = None
    # Add the handler to the global _handlerList (for cleanup on shutdown)
    _addHandlerRef(self)
    self.createLock()
</code></pre>
  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="sparktk.loggers.NullHandler.acquire">
    <p>def <span class="ident">acquire</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Acquire the I/O thread lock.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-sparktk.loggers.NullHandler.acquire', this);">Show source &equiv;</a></p>
  <div id="source-sparktk.loggers.NullHandler.acquire" class="source">
    <pre><code>def acquire(self):
    """
    Acquire the I/O thread lock.
    """
    if self.lock:
        self.lock.acquire()
</code></pre>
  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="sparktk.loggers.NullHandler.addFilter">
    <p>def <span class="ident">addFilter</span>(</p><p>self, filter)</p>
    </div>
    

    
  
    <div class="desc"><p>Add the specified filter to this handler.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-sparktk.loggers.NullHandler.addFilter', this);">Show source &equiv;</a></p>
  <div id="source-sparktk.loggers.NullHandler.addFilter" class="source">
    <pre><code>def addFilter(self, filter):
    """
    Add the specified filter to this handler.
    """
    if not (filter in self.filters):
        self.filters.append(filter)
</code></pre>
  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="sparktk.loggers.NullHandler.close">
    <p>def <span class="ident">close</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Tidy up any resources used by the handler.</p>
<p>This version removes the handler from an internal map of handlers,
_handlers, which is used for handler lookup by name. Subclasses
should ensure that this gets called from overridden close()
methods.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-sparktk.loggers.NullHandler.close', this);">Show source &equiv;</a></p>
  <div id="source-sparktk.loggers.NullHandler.close" class="source">
    <pre><code>def close(self):
    """
    Tidy up any resources used by the handler.
    This version removes the handler from an internal map of handlers,
    _handlers, which is used for handler lookup by name. Subclasses
    should ensure that this gets called from overridden close()
    methods.
    """
    #get the module data lock, as we're updating a shared structure.
    _acquireLock()
    try:    #unlikely to raise an exception, but you never know...
        if self._name and self._name in _handlers:
            del _handlers[self._name]
    finally:
        _releaseLock()
</code></pre>
  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="sparktk.loggers.NullHandler.createLock">
    <p>def <span class="ident">createLock</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Acquire a thread lock for serializing access to the underlying I/O.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-sparktk.loggers.NullHandler.createLock', this);">Show source &equiv;</a></p>
  <div id="source-sparktk.loggers.NullHandler.createLock" class="source">
    <pre><code>def createLock(self):
    """
    Acquire a thread lock for serializing access to the underlying I/O.
    """
    if thread:
        self.lock = threading.RLock()
    else:
        self.lock = None
</code></pre>
  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="sparktk.loggers.NullHandler.emit">
    <p>def <span class="ident">emit</span>(</p><p>self, record)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-sparktk.loggers.NullHandler.emit', this);">Show source &equiv;</a></p>
  <div id="source-sparktk.loggers.NullHandler.emit" class="source">
    <pre><code>def emit(self, record):
    pass
</code></pre>
  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="sparktk.loggers.NullHandler.filter">
    <p>def <span class="ident">filter</span>(</p><p>self, record)</p>
    </div>
    

    
  
    <div class="desc"><p>Determine if a record is loggable by consulting all the filters.</p>
<p>The default is to allow the record to be logged; any filter can veto
this and the record is then dropped. Returns a zero value if a record
is to be dropped, else non-zero.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-sparktk.loggers.NullHandler.filter', this);">Show source &equiv;</a></p>
  <div id="source-sparktk.loggers.NullHandler.filter" class="source">
    <pre><code>def filter(self, record):
    """
    Determine if a record is loggable by consulting all the filters.
    The default is to allow the record to be logged; any filter can veto
    this and the record is then dropped. Returns a zero value if a record
    is to be dropped, else non-zero.
    """
    rv = 1
    for f in self.filters:
        if not f.filter(record):
            rv = 0
            break
    return rv
</code></pre>
  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="sparktk.loggers.NullHandler.flush">
    <p>def <span class="ident">flush</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Ensure all logging output has been flushed.</p>
<p>This version does nothing and is intended to be implemented by
subclasses.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-sparktk.loggers.NullHandler.flush', this);">Show source &equiv;</a></p>
  <div id="source-sparktk.loggers.NullHandler.flush" class="source">
    <pre><code>def flush(self):
    """
    Ensure all logging output has been flushed.
    This version does nothing and is intended to be implemented by
    subclasses.
    """
    pass
</code></pre>
  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="sparktk.loggers.NullHandler.format">
    <p>def <span class="ident">format</span>(</p><p>self, record)</p>
    </div>
    

    
  
    <div class="desc"><p>Format the specified record.</p>
<p>If a formatter is set, use it. Otherwise, use the default formatter
for the module.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-sparktk.loggers.NullHandler.format', this);">Show source &equiv;</a></p>
  <div id="source-sparktk.loggers.NullHandler.format" class="source">
    <pre><code>def format(self, record):
    """
    Format the specified record.
    If a formatter is set, use it. Otherwise, use the default formatter
    for the module.
    """
    if self.formatter:
        fmt = self.formatter
    else:
        fmt = _defaultFormatter
    return fmt.format(record)
</code></pre>
  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="sparktk.loggers.NullHandler.get_name">
    <p>def <span class="ident">get_name</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-sparktk.loggers.NullHandler.get_name', this);">Show source &equiv;</a></p>
  <div id="source-sparktk.loggers.NullHandler.get_name" class="source">
    <pre><code>def get_name(self):
    return self._name
</code></pre>
  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="sparktk.loggers.NullHandler.handle">
    <p>def <span class="ident">handle</span>(</p><p>self, record)</p>
    </div>
    

    
  
    <div class="desc"><p>Conditionally emit the specified logging record.</p>
<p>Emission depends on filters which may have been added to the handler.
Wrap the actual emission of the record with acquisition/release of
the I/O thread lock. Returns whether the filter passed the record for
emission.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-sparktk.loggers.NullHandler.handle', this);">Show source &equiv;</a></p>
  <div id="source-sparktk.loggers.NullHandler.handle" class="source">
    <pre><code>def handle(self, record):
    """
    Conditionally emit the specified logging record.
    Emission depends on filters which may have been added to the handler.
    Wrap the actual emission of the record with acquisition/release of
    the I/O thread lock. Returns whether the filter passed the record for
    emission.
    """
    rv = self.filter(record)
    if rv:
        self.acquire()
        try:
            self.emit(record)
        finally:
            self.release()
    return rv
</code></pre>
  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="sparktk.loggers.NullHandler.handleError">
    <p>def <span class="ident">handleError</span>(</p><p>self, record)</p>
    </div>
    

    
  
    <div class="desc"><p>Handle errors which occur during an emit() call.</p>
<p>This method should be called from handlers when an exception is
encountered during an emit() call. If raiseExceptions is false,
exceptions get silently ignored. This is what is mostly wanted
for a logging system - most users will not care about errors in
the logging system, they are more interested in application errors.
You could, however, replace this with a custom handler if you wish.
The record which was being processed is passed in to this method.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-sparktk.loggers.NullHandler.handleError', this);">Show source &equiv;</a></p>
  <div id="source-sparktk.loggers.NullHandler.handleError" class="source">
    <pre><code>def handleError(self, record):
    """
    Handle errors which occur during an emit() call.
    This method should be called from handlers when an exception is
    encountered during an emit() call. If raiseExceptions is false,
    exceptions get silently ignored. This is what is mostly wanted
    for a logging system - most users will not care about errors in
    the logging system, they are more interested in application errors.
    You could, however, replace this with a custom handler if you wish.
    The record which was being processed is passed in to this method.
    """
    if raiseExceptions and sys.stderr:  # see issue 13807
        ei = sys.exc_info()
        try:
            traceback.print_exception(ei[0], ei[1], ei[2],
                                      None, sys.stderr)
            sys.stderr.write('Logged from file %s, line %s\n' % (
                             record.filename, record.lineno))
        except IOError:
            pass    # see issue 5971
        finally:
            del ei
</code></pre>
  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="sparktk.loggers.NullHandler.release">
    <p>def <span class="ident">release</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Release the I/O thread lock.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-sparktk.loggers.NullHandler.release', this);">Show source &equiv;</a></p>
  <div id="source-sparktk.loggers.NullHandler.release" class="source">
    <pre><code>def release(self):
    """
    Release the I/O thread lock.
    """
    if self.lock:
        self.lock.release()
</code></pre>
  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="sparktk.loggers.NullHandler.removeFilter">
    <p>def <span class="ident">removeFilter</span>(</p><p>self, filter)</p>
    </div>
    

    
  
    <div class="desc"><p>Remove the specified filter from this handler.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-sparktk.loggers.NullHandler.removeFilter', this);">Show source &equiv;</a></p>
  <div id="source-sparktk.loggers.NullHandler.removeFilter" class="source">
    <pre><code>def removeFilter(self, filter):
    """
    Remove the specified filter from this handler.
    """
    if filter in self.filters:
        self.filters.remove(filter)
</code></pre>
  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="sparktk.loggers.NullHandler.setFormatter">
    <p>def <span class="ident">setFormatter</span>(</p><p>self, fmt)</p>
    </div>
    

    
  
    <div class="desc"><p>Set the formatter for this handler.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-sparktk.loggers.NullHandler.setFormatter', this);">Show source &equiv;</a></p>
  <div id="source-sparktk.loggers.NullHandler.setFormatter" class="source">
    <pre><code>def setFormatter(self, fmt):
    """
    Set the formatter for this handler.
    """
    self.formatter = fmt
</code></pre>
  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="sparktk.loggers.NullHandler.setLevel">
    <p>def <span class="ident">setLevel</span>(</p><p>self, level)</p>
    </div>
    

    
  
    <div class="desc"><p>Set the logging level of this handler.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-sparktk.loggers.NullHandler.setLevel', this);">Show source &equiv;</a></p>
  <div id="source-sparktk.loggers.NullHandler.setLevel" class="source">
    <pre><code>def setLevel(self, level):
    """
    Set the logging level of this handler.
    """
    self.level = _checkLevel(level)
</code></pre>
  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="sparktk.loggers.NullHandler.set_name">
    <p>def <span class="ident">set_name</span>(</p><p>self, name)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-sparktk.loggers.NullHandler.set_name', this);">Show source &equiv;</a></p>
  <div id="source-sparktk.loggers.NullHandler.set_name" class="source">
    <pre><code>def set_name(self, name):
    _acquireLock()
    try:
        if self._name in _handlers:
            del _handlers[self._name]
        self._name = name
        if name:
            _handlers[name] = self
    finally:
        _releaseLock()
</code></pre>
  </div>
</div>

  </div>
  
      </div>
      </div>

  </section>

        </div>
        <div class="clear" />
        <footer id="footer">
          <div>
            spark-tk Python API Documentation
          </div>
        </footer>
      </article>
  </div>
</body>
</html>
